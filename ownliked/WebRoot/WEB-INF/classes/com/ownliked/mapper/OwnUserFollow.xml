<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="ownUserFollowSqlMap">
	<resultMap type="com.ownliked.pojo.OwnUserFollow" id="ownUserFollowMap">
		<id property="id" column="ID" />
		<result property="aUserId" column="a_userId" />
		<result property="bUserId" column="b_userId" />
		<result property="boardId" column="boardId" />
		<result property="createTime" column="createTime" />
	</resultMap>
	<sql id="sqlOwnUserFollow">
		SELECT * FROM own_user_follow t
	</sql>
	<select id="countOwnUserFollow" resultType="int" parameterType="ownUserFollow">
		SELECT COUNT(t.id) FROM own_user_follow t
		<where>
			<if test="aUserId != 0">AND t.a_userId = #{aUserId}</if>
			<if test="bUserId != 0">AND t.b_userId = #{bUserId}</if>
			<if test="boardId != 0">AND t.boardId = #{boardId}</if>
		</where>
	</select>
	<select id="queryOwnUserFollow" parameterType="ownUserFollow" resultMap="ownUserFollowMap">
		SELECT 
			* 
		FROM own_user_follow  
			
		ORDER BY id DESC 
		<trim prefix="LIMIT">
			0, 4
		</trim>
	</select>
	<select id="findOwnUserFollow" parameterType="ownUserFollow" resultType="ownUserFollow">
		SELECT * FROM own_user_follow t WHERE t.id = #{id}
	</select>
	<insert id="insertOwnUserFollow" parameterType="ownUserFollow" useGeneratedKeys="true" keyProperty="id">
		INSERT INTO own_user_follow(a_userId, b_userId, boardId, createTime) VALUES
			(#{aUserId}, #{bUserId}, #{boardId}, NOW())
	</insert>
	<update id="updateOwnUserFollow" parameterType="ownUserFollow">
		UPDATE own_user_follow t 
		<set>
			<if test="aUserId != 0">
				t.aUserId = #{aUserId}
			</if>
			<if test="bUserId != 0">
				t.bUserId = #{bUserId}
			</if>
			<if test="boardId != 0">
				t.boardId = #{boardId}
			</if>
			<if test="createTime != null and createTime != ''">
				t.createTime = #{createTime},
			</if>
		</set>
		WHERE t.id = #{id}
	</update>
	<delete id="deleteOwnUserFollow" parameterType="ownUserFollow">
		DELETE FROM own_user_follow 
		<where>
			<choose>
				<when test="id != 0">id = #{id}</when>
				<otherwise>
					<if test="aUserId != 0">
						AND a_userId = #{aUserId}
					</if>
					<if test="bUserId != 0">
						AND b_userId = #{bUserId}
					</if>
					<if test="boardId != 0">
						AND boardId = #{boardId}
					</if>
				</otherwise>
			</choose>
		</where>
	</delete>
</mapper>
